(()=>{var e={};e.id=283,e.ids=[283],e.modules={408:()=>{},523:(e,r,t)=>{"use strict";t.d(r,{z:()=>n});var s=t(2572);!function(){var e=Error("Cannot find module '@supabase/ssr'");throw e.code="MODULE_NOT_FOUND",e}();let o=process.env.NEXT_PUBLIC_SUPABASE_URL||"http://supabasekong-zcc4coo08kkk0ok88o0840k0.89.117.61.193.sslip.io:8000",a=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS1kZW1vIiwicm9sZSI6ImFub24iLCJleHAiOjE5ODM4MTI5OTZ9.CRXP1A7WOeoJeXxjNni43kdQwgnWNReilDMblYTn_I0";process.env.NEXT_PUBLIC_SUPABASE_URL&&Object(function(){var e=Error("Cannot find module '@supabase/ssr'");throw e.code="MODULE_NOT_FOUND",e}())(o,a);let n=()=>process.env.NEXT_PUBLIC_SUPABASE_URL?(0,s.UU)(o,a,{auth:{autoRefreshToken:!1,persistSession:!1}}):null},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1262:()=>{},1630:e=>{"use strict";e.exports=require("http")},1645:e=>{"use strict";e.exports=require("net")},1997:e=>{"use strict";e.exports=require("punycode")},2503:()=>{},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3844:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>m,routeModule:()=>p,serverHooks:()=>h,workAsyncStorage:()=>d,workUnitAsyncStorage:()=>l});var s={};t.r(s),t.d(s,{GET:()=>c});var o=t(8106),a=t(8819),n=t(2050),i=t(4235),u=t(523);async function c(e){if(e.headers.get("authorization")!==`Bearer ${process.env.CRON_SECRET}`)return i.NextResponse.json({error:"Unauthorized"},{status:401});try{let e=(0,u.z)(),r=[{id:`auto-refresh-${Date.now()}-1`,indicator:"PIB France (Auto-refresh)",value:2800+100*Math.random(),date:new Date().toISOString().split("T")[0],source:"INSEE",unit:"Milliards â‚¬",frequency:"QUARTERLY",geography:"France",category:"GDP",metadata:{auto_generated:!0,refresh_timestamp:new Date().toISOString()}},{id:`auto-refresh-${Date.now()}-2`,indicator:"Taux de ch\xf4mage (Auto-refresh)",value:7+2*Math.random(),date:new Date().toISOString().split("T")[0],source:"INSEE",unit:"%",frequency:"MONTHLY",geography:"France",category:"UNEMPLOYMENT",metadata:{auto_generated:!0,refresh_timestamp:new Date().toISOString()}}];if(e){let{data:t,error:s}=await e.from("economic_data").upsert(r,{onConflict:"id"});if(s)throw s}return e&&await e.from("data_sources").upsert({name:"AUTO_REFRESH",url:"internal://cron",last_sync:new Date().toISOString(),is_active:!0},{onConflict:"name"}),i.NextResponse.json({success:!0,message:`${r.length} enregistrements mis \xe0 jour`,timestamp:new Date().toISOString()})}catch(e){return console.error("Erreur cron refresh:",e),i.NextResponse.json({success:!1,error:e instanceof Error?e.message:"Erreur inconnue"},{status:500})}}let p=new o.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/cron/refresh-data/route",pathname:"/api/cron/refresh-data",filename:"route",bundlePath:"app/api/cron/refresh-data/route"},resolvedPagePath:"/Users/manu/Documents/DEV/stats-insee/apps/web/src/app/api/cron/refresh-data/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:d,workUnitAsyncStorage:l,serverHooks:h}=p;function m(){return(0,n.patchFetch)({workAsyncStorage:d,workUnitAsyncStorage:l})}},4075:e=>{"use strict";e.exports=require("zlib")},4631:e=>{"use strict";e.exports=require("tls")},4735:e=>{"use strict";e.exports=require("events")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5511:e=>{"use strict";e.exports=require("crypto")},5591:e=>{"use strict";e.exports=require("https")},7032:()=>{},7910:e=>{"use strict";e.exports=require("stream")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9428:e=>{"use strict";e.exports=require("buffer")},9551:e=>{"use strict";e.exports=require("url")}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[191,744,572],()=>t(3844));module.exports=s})();