(()=>{var e={};e.id=620,e.ids=[620],e.modules={408:()=>{},523:(e,t,r)=>{"use strict";r.d(t,{z:()=>i});var s=r(2572);!function(){var e=Error("Cannot find module '@supabase/ssr'");throw e.code="MODULE_NOT_FOUND",e}();let o=process.env.NEXT_PUBLIC_SUPABASE_URL||"http://supabasekong-zcc4coo08kkk0ok88o0840k0.89.117.61.193.sslip.io:8000",n=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS1kZW1vIiwicm9sZSI6ImFub24iLCJleHAiOjE5ODM4MTI5OTZ9.CRXP1A7WOeoJeXxjNni43kdQwgnWNReilDMblYTn_I0";process.env.NEXT_PUBLIC_SUPABASE_URL&&Object(function(){var e=Error("Cannot find module '@supabase/ssr'");throw e.code="MODULE_NOT_FOUND",e}())(o,n);let i=()=>process.env.NEXT_PUBLIC_SUPABASE_URL?(0,s.UU)(o,n,{auth:{autoRefreshToken:!1,persistSession:!1}}):null},695:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>v,routeModule:()=>d,serverHooks:()=>m,workAsyncStorage:()=>l,workUnitAsyncStorage:()=>x});var s={};r.r(s),r.d(s,{POST:()=>p});var o=r(8106),n=r(8819),i=r(2050),a=r(4235),u=r(523);async function p(e){try{let{format:t,includeCharts:r,dateRange:s,selectedData:o}=await e.json();if(!s?.start||!s?.end)return a.NextResponse.json({success:!1,error:"Date range is required"},{status:400});let n=(0,u.z)();if(!n)return a.NextResponse.json({success:!1,error:"Mode d\xe9mo : Export d\xe9sactiv\xe9. Configurez Supabase pour activer cette fonctionnalit\xe9."},{status:501});let i=n.from("economic_data").select("*").gte("date",s.start).lte("date",s.end).order("date",{ascending:!0}),{data:p,error:d}=await i;if(d)return a.NextResponse.json({success:!1,error:"Erreur lors de la r\xe9cup\xe9ration des donn\xe9es"},{status:500});let l=p||[];switch(t){case"csv":{let e=c(l);return new a.NextResponse(e,{status:200,headers:{"Content-Type":"text/csv","Content-Disposition":`attachment; filename="donnees-economiques-${new Date().toISOString().split("T")[0]}.csv"`}})}case"json":return a.NextResponse.json({success:!0,data:l,format:"PDF",includeCharts:r});case"xlsx":{let e=c(l);return new a.NextResponse(e,{status:200,headers:{"Content-Type":"application/vnd.ms-excel","Content-Disposition":`attachment; filename="donnees-economiques-${new Date().toISOString().split("T")[0]}.xls"`}})}default:return a.NextResponse.json({success:!1,error:"Format d'export non support\xe9"},{status:400})}}catch(e){return console.error("Erreur export:",e),a.NextResponse.json({success:!1,error:"Erreur serveur interne"},{status:500})}}function c(e){return 0===e.length?"Aucune donn\xe9e \xe0 exporter":["ID,Indicateur,Valeur,Date,Source,Unit\xe9,Fr\xe9quence,G\xe9ographie,Cat\xe9gorie,Cr\xe9\xe9 le,Mis \xe0 jour le",...e.map(e=>[e.id,e.indicator,e.value,e.date,e.source,e.unit,e.frequency,e.geography,e.category,e.created_at,e.updated_at]).map(e=>e.map(e=>"string"==typeof e&&e.includes(",")?`"${e.replace(/"/g,'""')}"`:e).join(","))].join("\n")}let d=new o.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/export/route",pathname:"/api/export",filename:"route",bundlePath:"app/api/export/route"},resolvedPagePath:"/Users/manu/Documents/DEV/stats-insee/apps/web/src/app/api/export/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:l,workUnitAsyncStorage:x,serverHooks:m}=d;function v(){return(0,i.patchFetch)({workAsyncStorage:l,workUnitAsyncStorage:x})}},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1262:()=>{},1630:e=>{"use strict";e.exports=require("http")},1645:e=>{"use strict";e.exports=require("net")},1997:e=>{"use strict";e.exports=require("punycode")},2503:()=>{},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4075:e=>{"use strict";e.exports=require("zlib")},4631:e=>{"use strict";e.exports=require("tls")},4735:e=>{"use strict";e.exports=require("events")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5511:e=>{"use strict";e.exports=require("crypto")},5591:e=>{"use strict";e.exports=require("https")},7032:()=>{},7910:e=>{"use strict";e.exports=require("stream")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9428:e=>{"use strict";e.exports=require("buffer")},9551:e=>{"use strict";e.exports=require("url")}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[191,744,572],()=>r(695));module.exports=s})();